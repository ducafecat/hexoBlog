---
title: Dart 语言
top: false
date: 2018-09-04 13:27:30
tags:
categories:
thumbnail:
---

# Dart 语言

## 安装

brew 方式安装

```sh
brew tap dart-lang/dart
brew install dart
```

手动方式

```sh
curl https://storage.googleapis.com/dart-archive/channels/stable/release/2.0.0/sdk/dartsdk-macos-x64-release.zip

vim ~/.bash_profile
export PATH=/your/sdk/dart/bin:$PATH
source ~/.bash_profile
```

## 变量

### var

自适应变量

```dart
dynamic val = 'abc';
```

### dynamic

动态类型

```dart
dynamic val = 'abc';
val = 123;
```

### final

锁定变量对应地址或者直接值

```dart
final name = ['Bob', 'abc'];
name = ['aaa'];
```

但是你可以修改地址指向的值

```dart
final name = ['Bob', 'abc'];
name[0] = 'aaa';
```

### const

直接锁定变量地址、对应的值

```dart
const name = ['Bob', 'abc'];
name[0] = 'aaa';
```

### const final 比较

`const` 定义的是编译时常量，只能用编译时常量来初始化
`final` 定义的常量可以用变量来初始化

```dart
final time = new DateTime.now(); //Ok
const time = new DateTime.now(); //Error，new DateTime.now()不是const常量
```

### 默认值

默认值永远是 `null`

```dart
String val;
assert(val == null);
```

## 类型系统

### int

```dart
int x = 1;
int hex = 0xDEADBEEF;
```

### double

```dart
double y = 1.1;
double exponents = 1.42e5;
```

### 位移操作

```dart
assert((3 << 1) == 6); // 0011 << 1 == 0110
assert((3 >> 1) == 1); // 0011 >> 1 == 0001
assert((3 | 4) == 7); // 0011 | 0100 == 0111
```

### String

单引号 双引号 都可以定义

```dart
var s1 = 'Single quotes work well for string literals.';
var s2 = "Double quotes work just as well.";
```

模板支持 `$expression` 或者 `${expression}`

```dart
var val = '123';
var s1 = 'string interpolation $val';
var s2 = 'string interpolation ${val}';
```

可以用 '+' 或者 '换行' 连接字符串

```dart
var s1 = 'String '
    'concatenation'
    " works even over line breaks.";
var s2 = 'The + operator ' + 'works, as well.';
```

`'''` 或者 `"""` 支持多行显示

```dart
var s1 = '''
You can create
multi-line strings like this one.
''';
var s2 = """This is also a
multi-line string.""";
```

字符前加 `r` 表示不转义

```dart
var s = r'In a raw string, not even \n gets special treatment.';
```

定义 `const` 字符串的变量 也必须是 `const`

```dart
const aConstNum = 0;
const aConstBool = true;
const aConstString = 'a constant string';
const validConstString = '$aConstNum $aConstBool $aConstString';
```

### Booleans

`if (nonbooleanValue)` 或 `assert (nonbooleanValue)` 方式使用

`assert` 检查 如果不符合中断程序

```dart
// Check for an empty string.
var fullName = '';
assert(fullName.isEmpty);

// Check for zero.
var hitPoints = 0;
assert(hitPoints <= 0);

// Check for null.
var unicorn;
assert(unicorn == null);

// Check for NaN.
var iMeantToDoThis = 0 / 0;
assert(iMeantToDoThis.isNaN);
```

### Lists

```dart
var list = [1, 2, 3];
assert(list.length == 3);
assert(list[1] == 2);

list[1] = 1;
assert(list[1] == 1);
```

### Maps

```dart
var gifts = {
  // Key:    Value
  'first': 'partridge',
  'second': 'turtledoves',
  'fifth': 'golden rings'
};

var nobleGases = {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};
```

```dart
var gifts = Map();
gifts['first'] = 'partridge';
gifts['second'] = 'turtledoves';
gifts['fifth'] = 'golden rings';

var nobleGases = Map();
nobleGases[2] = 'helium';
nobleGases[10] = 'neon';
nobleGases[18] = 'argon';
```

### Runes

字符符号

```dart
  var clapping = '\u{1f44f}';
  print(clapping);
  print(clapping.codeUnits);
  print(clapping.runes.toList());

  Runes input = new Runes(
      '\u2665  \u{1f605}  \u{1f60e}  \u{1f47b}  \u{1f596}  \u{1f44d}');
  print(new String.fromCharCodes(input));
```

## 函数

### 定义

当没有指定返回值的时候，函数返回 `null`

```dart
bool isNoble(int atomicNumber) {
  return _nobleGases[atomicNumber] != null;
}
```

`is` 操作符判断对象是否为指定类型

```dart
assert(isNoble is Function);
```

### 箭头函数

只有一个表达式时 用箭头函数

```dart
doHello(String name) => 'Hello $name!';
var val = doHello('aaa');
```

### `typedef` 函数别名

```dart
typedef int Add(int a, int b);
int Subtract(int a, int b) => a - b;

print(Subtract is Function);
print(Subtract is Add);
```

### 函数闭包

```dart
Function makeSubstract(num n)
{
  return (num i) => n - i;
}

void main()
{
  var x = makeSubstract(5);
  print(x(2));
}
```

```dart
var callbacks = [];
for (var i = 0; i < 3; i++) {
  callbacks.add(() => print('Save $i'));
}
callbacks.forEach((c) => c()); // 分别输出 0 1 2
```

### 可选参数

命名可选参数使用大括号 `{}`，默认值用冒号 `:`

```dart
FunX(a, {b, c:3, d:4, e})
{
  print('$a $b $c $d $e');
}

FunX(1, b:3, d:5);
```

### 位置参数

位置可选参数使用方括号 `[]`，默认值用等号 `=`

```dart
FunY(a, [b, c=3, d=4, e])
{
  print('$a $b $c $d $e');
}
FunY(1, 3, 5);
```

## 操作符

###
###
###
###

##

###
###
###

##

##

##

##

##

## 参考

- [Install the SDK](https://webdev.dartlang.org/tools/sdk#install)
- [Flutter Codelabs](https://codelabs.flutter-io.cn/)
- [Dart dart:core library](https://api.dartlang.org/stable/2.0.0/dart-core/dart-core-library.html#classes)
- [A Tour of the Dart Language](https://www.dartlang.org/guides/language/language-tour)
- [在线 Dart 面板](https://dartpad.dartlang.org)
- [Dart 中文社区](http://www.cndartlang.com/dart/page/4)

---

© 会煮咖啡的猫咪
微信 ducafecat
[镜像](ducafecat.github.io) [Github](https://github.com/ducafecat)
